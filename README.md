# Video Violence Detection: CNN+GRU vs. R(2+1)D

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–≤—É—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –Ω–∞—Å–∏–ª–∏—è –Ω–∞ –≤–∏–¥–µ–æ. –û—Å–Ω–æ–≤–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç —Å–¥–µ–ª–∞–Ω –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ 2D-—Å–≤–µ—Ä—Ç–æ–∫ —Å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–º–∏ —Å–ª–æ—è–º–∏ –ø—Ä–æ—Ç–∏–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π 3D-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –±—É–º–∞–≥–µ, **—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (CNN+GRU) –ø–æ–∫–∞–∑–∞–ª —Å–µ–±—è –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | CNN + GRU (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è) | R(2+1)D (Fine-tuned) |
| --- | --- | --- |
| **–§–∞–π–ª –º–æ–¥–µ–ª–∏** | `model_acc_1.0.86.safetensors` | `model_acc_99.66.safetensors` |
| **–ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | EfficientNet-B0 + 2-layer GRU | R(2+1)D (3D Convolutions) |
| **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã** | –í—ã—Å–æ–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —à—É–º–∞–º | –û—Ç–ª–∏—á–Ω–æ –ª–æ–≤–∏—Ç —Å–ª–æ–∂–Ω—ã–µ –º–∏–∫—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è |
| **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** | –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–¥—Ä—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ | –í—ã—á–∏—Å–ª—è–µ—Ç –≤—Ä–µ–º—è –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–º–µ—Å—Ç–µ |
| **–¢–æ—á–Ω–æ—Å—Ç—å (Val)** | ~98-99% | ~99.6% |

---

## üèó –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### 1. –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (EfficientNet-B0 + GRU)

–≠—Ç–∞ –º–æ–¥–µ–ª—å —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∑–∞–¥–∞—á—É –Ω–∞ –¥–≤–∞ —ç—Ç–∞–ø–∞:

* **–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** EfficientNet-B0 –∏–∑–≤–ª–µ–∫–∞–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–∞–¥—Ä–∞.
* **–í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑:** –î–≤—É—Å–ª–æ–π–Ω–∞—è —Å–µ—Ç—å GRU (Hidden size: 256) –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ "—á—Ç–æ –Ω–∞ –∫–∞–¥—Ä–µ" –∏ "–∫–∞–∫ –æ–Ω–æ –¥–≤–∏–∂–µ—Ç—Å—è" –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –º–µ–Ω—å—à–µ –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–æ–Ω—ã –∏ –ª—É—á—à–µ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –¥–∏–Ω–∞–º–∏–∫–µ —Å–æ–±—ã—Ç–∏–π.

### 2. Fine-tuned –º–æ–¥–µ–ª—å (R(2+1)D)

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è "—Ñ–∞–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ" 3D-—Å–≤–µ—Ä—Ç–∫–∏.

* –í–º–µ—Å—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π 3D-—Å–≤–µ—Ä—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è 2D (–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ) –∏ 1D (–≤—Ä–µ–º—è) —Ñ–∏–ª—å—Ç—Ä–æ–≤.
* **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–æ–¥–µ–ª—å –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –¥–≤–∏–∂–µ–Ω–∏—è, –Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

---

## üî¶ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ Lighting Bias (–û—Å–≤–µ—â–µ–Ω–∏–µ)

–í —Ö–æ–¥–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã—è–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –æ—Å–≤–µ—â–µ–Ω–∏—è:

1. **Low Light (–¢–µ–º–Ω–æ—Ç–∞):** –ú–æ–¥–µ–ª—å —Å–∫–ª–æ–Ω–Ω–∞ —á–∞—â–µ –≤—ã–¥–∞–≤–∞—Ç—å –≤–µ—Ä–¥–∏–∫—Ç `Violence`. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –≤ –æ–±—É—á–∞—é—â–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –º–Ω–æ–≥–æ —Å—Ü–µ–Ω –Ω–∞—Å–∏–ª–∏—è —Å–Ω—è—Ç–æ –≤ —Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ—É–ª–∫–∞—Ö –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–∞–º–µ—Ä—ã –Ω–æ—á–Ω–æ–≥–æ –≤–∏–¥–µ–Ω–∏—è.
2. **Bright Light (–°–≤–µ—Ç):** –ß–∞—â–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `Safe`. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ "–º–∏—Ä–Ω—ã—Ö" –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –ø—Ä–æ–≥—É–ª–∫–∏ –≤ –ø–∞—Ä–∫–∞—Ö –∏–ª–∏ –±—ã—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω—ã –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏.

**–í—ã–≤–æ–¥:** –°–≤–µ—Ç –≤—ã—Å—Ç—É–ø–∞–µ—Ç –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∫–æ—Å–≤–µ–Ω–Ω–æ–π "–ø–æ–¥—Å–∫–∞–∑–∫–æ–π". –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω—è—Ç—å –¥–∞—Ç–∞—Å–µ—Ç —Å–≤–µ—Ç–ª—ã–º–∏ —Å—Ü–µ–Ω–∞–º–∏ –¥—Ä–∞–∫ –∏ —Ç–µ–º–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞–º–∏ –º–∏—Ä–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
pip install torch torchvision decord safetensors opencv-python tqdm

```

### 2. –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ—É—Ç–±—É–∫ `cnn_gru.ipynb` –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞.
–ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏:

1. –í–∏–¥–µ–æ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ **16 –∫–∞–¥—Ä–æ–≤**.
2. –ö–∞–¥—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ EfficientNet.
3. GRU –≤—ã–Ω–æ—Å–∏—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≤–µ—Ä–¥–∏–∫—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## üì∫ –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã

–ú–æ–¥–µ–ª—å –±—ã–ª–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ "–¥–∏–∫–∏—Ö" —É—Å–ª–æ–≤–∏—è—Ö:

* [–ü—Ä–∏–º–µ—Ä 1](https://www.youtube.com/watch?v=tQp2EgxGmeo)
* [–ü—Ä–∏–º–µ—Ä 2](https://youtu.be/6949uuxkG6Y)
* [–ü—Ä–∏–º–µ—Ä 3](https://youtu.be/6AR0Uj-prHQ)

---

## –ê–Ω–∞–ª–∏–∑ –∏ –≤—ã–≤–æ–¥—ã –ø–æ –∏—Ç–æ–≥–∞–º

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:
- **R(2+1)D**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ SOTA-–ø–æ–¥—Ö–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏–¥–µ–æ. –•–æ—Ä–æ—à–æ —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É –¥–≤–∏–∂–µ–Ω–∏–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.
- **CNN + GRU**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è Real-time –∑–∞–¥–∞—á. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –º–µ–Ω—å—à–µ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Data Bias):
–í —Ö–æ–¥–µ –æ–±—É—á–µ–Ω–∏—è –≤—ã—è–≤–ª–µ–Ω —Å–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–∫–æ—Å –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ:
1. **–£—Å–ª–æ–≤–∏—è –æ—Å–≤–µ—â–µ–Ω–∏—è**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ü–µ–ª–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è, —á—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–∏ –¥–ª—è –¥–Ω–µ–≤–Ω—ã—Ö —Å—Ü–µ–Ω –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.
2. **–î–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Å–º–µ—â–µ–Ω–∏–µ**: –í –≤—ã–±–æ—Ä–∫–µ –ø—Ä–µ–≤–∞–ª–∏—Ä—É—é—Ç –æ–±—ä–µ–∫—Ç—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Ç–∏–ø–æ–º –≤–Ω–µ—à–Ω–æ—Å—Ç–∏, —á—Ç–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∂–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è Production:
–î–ª—è –≤—ã–≤–æ–¥–∞ –º–æ–¥–µ–ª–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–µ—Ç–æ–¥—ã Low-light enhancement –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ –Ω–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ö.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

* `cnn_gru.ipynb` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
* `Violance_detection.ipynb` ‚Äî —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å R(2+1)D.
* `*.safetensors` ‚Äî –≤–µ—Å–∞ –º–æ–¥–µ–ª–µ–π –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –∏ –±—ã—Å—Ç—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.
